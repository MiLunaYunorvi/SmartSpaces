
{% extends "index_oficial.html" %}
{% load static %}
{% block content %}
<div class="row">
    <div class="col-lg-6 mb-4 order-0">
        <div class="card">
          <div class="d-flex align-items-end row">
            <div class="col-sm-8">
              <div class="card-body">
                <h2 class="card-title text-primary"> LABORATORIO</h2>
                  <h4 class="fw-bold">DISPONIBLE </h4> 
                  
                {% block boton %}
                    <!-- inicio boton de reserva -->
                <div class="col-lg-8 col-md-8">

                  <div class="mt-4">
                    
                      <button
                        class="btn btn-primary"
                        type="button"
                        data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasBoth"
                        aria-controls="offcanvasBoth"
                      >
                        RESERVAR
                      </button>

                    <button
                      class="btn btn-primary"
                      type="button"
                      onclick = "window.location.href='/monitoring'"
                    >
                      MONITOREAR
                    </button>
                    <!-- inicio ventana de reserva -->
                    <div
                      class="offcanvas offcanvas-end"
                      data-bs-scroll="true"
                      tabindex="-1"
                      id="offcanvasBoth"
                      aria-labelledby="offcanvasBothLabel"
                      >
                      <form action = "" method = "post">{% csrf_token %}
                      <div class="offcanvas-body my-auto mx-0 flex-grow-0">
                        <div class="card mb-6">
                          <h5 class="card-header">RESERVA DE SALAS</h5>
                          <div class="card-body">
                                <div class="mb-3">
                                  <label for="exampleFormControlSelect1" class="form-label">SELECCIONE LA SALA: </label>
                                  <select name="salaescogida" class="form-select" id="exampleFormControlSelect1" aria-labeel="Default select example">
                                    <option selected>Open this select menu</option>
                                    <option value="1">Laboratorio</option>
                                    <option value="2">MacchuPicchu</option>
                                  </select>
                                </div>
                                <div class="mb-3 ">
                                  <label for="fecharequerida" class=" col-form-label">FECHA</label>
                                  <div class="col-md-10">
                                    <input name='freserva' class="form-control" type="date" value="2021-06-18" id="fecharequerida"/>
                                  </div>
                                </div>
                          </div>
                        </div> 
                        <input type="submit" class="btn btn-primary mb-2 d-grid w-100" value="BUSCAR DISPONIBILIDAD">
                        </form>
                        <button type="button" class="btn btn-outline-secondary d-grid w-100" data-bs-dismiss="offcanvas">Cancel</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>  
          {% endblock boton %}
          <!-- FIN BOTON DE RESRVA -->
        
          
       
            <div class="col-sm-1 text-center text-right">
              <div class="card-body pb-0 px-0">
                <img
                  src="{% static 'assets/img/illustrations/man-with-laptop-light.png' %}"
                  height="100"
                  alt="View Badge User"
                  data-app-dark-img="illustrations/man-with-laptop-dark.png"
                  data-app-light-img="illustrations/man-with-laptop-light.png"
                />
              </div>
            </div>

          </div>
        </div>
      </div>

    <div class="col-lg-6 col-md-5 order-1">
                  <div class="row">
                    <div class="col-lg-6 col-md-12 col-6 mb-5">
                      <div class="card">
                        <div class="card-body">
                          <div class="card-title d-flex align-items-start justify-content-between">
                            <div class="avatar flex-shrink-0">
                              <img
                                src="{% static 'assets/img/icons/unicons/temp.png' %}"
                                alt="chart success"
                                class="rounded"
                              />
                            </div>
                          </div>
                          <h3 class="text-success d-block mb-1">Temperatura</h3>
                          <p> </p>
                          <h3 class="card-title text-nowrap mb-1" id='temperatura' >{{tempe}}</h3>
                          
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-6 col-md-12 col-6 mb-4">
                      <div class="card">
                        <div class="card-body">
                          <div class="card-title d-flex align-items-start justify-content-between">
                            <div class="avatar flex-shrink-0">
                              <img
                                src="{% static 'assets/img/icons/unicons/humidity.png' %}"
                                alt="Credit Card"
                                class="rounded"
                              />
                            </div>
                            
                          </div>
                          <h3 class="text-success d-block mb-1">Humedad<h3>
                          <h3 class="card-title text-nowrap mb-1" id="humedad">{{humedad}}</h3>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
    </div>
<div class="row">
  
    <!-- Order Statistics -->
    <div class="col-md-6 col-lg-4 col-xl-4 order-0 mb-4">
        <div class="card h-100">
          <div class="card-header d-flex align-items-center justify-content-between pb-0">
            <div class="card-title mb-0">
              <h5 class="m-0 me-2 text-primary">LABORATORIO</h5>
            </div>
          </div>
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="d-flex flex-column align-items-center gap-1"  >
                <h2 class="mb-2" id='personas'>{{persona}} </h2>
              </div>
        
            </div>
            <ul class="p-0 m-0">
              <li class="d-flex mb-4 pb-1">
                <div class="avatar flex-shrink-0 me-3">
                  <span class="avatar-initial rounded bg-label-primary"
                  
                  >5</span>
                </div>
                <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                  <div class="me-2">
                    <h6 class="mb-0">Capacidad</h6>
                    <small class="text-muted">del laboratorio</small>
                  </div>
                </div>
              </li>
              <li class="d-flex mb-4 pb-1">
                <div class="avatar flex-shrink-0 me-3">
                  <span class="avatar-initial rounded bg-label-success" id="personas1" >{{personas}}</span>
                </div>
                <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                  <div class="me-2">
                    <h6 class="mb-0">Ocupaci√≤n</h6>
                    <small class="text-muted">del laboratorio</small>
                  </div>
                
                </div>
              </li>
              
            </ul>
          </div>
        </div>
      </div>
      <!--/ Order Statistics -->


      {% block principal%}

      {% endblock principal %}


      

      </div>



</div>

<script>

    var socket = new WebSocket('ws://localhost:8000/ws/laboratorio/');
    socket.onmessage = function(event){
        var data = JSON.parse(event.data);
        console.log(data);
        document.querySelector('#temperatura').innerText = data.temperatura;
        document.querySelector('#humedad').innerText = data.humedad;
        document.querySelector('#personas').innerText = data.personas + ' personas';
        document.querySelector('#personas1').innerText = data.personas;
        document.querySelector('#puerta').innerText = data.puerta;
        

    }
</script>

{% endblock content %}